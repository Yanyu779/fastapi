<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flask + React å…¨æ ˆé¡¹ç›®æ¼”ç¤º</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .demo-card { margin: 20px 0; }
        .api-response { background: #f8f9fa; border-left: 4px solid #007bff; padding: 15px; margin: 10px 0; }
        .success { color: #28a745; }
        .error { color: #dc3545; }
    </style>
</head>
<body>
    <div class="container mt-4">
        <div class="row">
            <div class="col-12">
                <div class="text-center mb-4">
                    <h1 class="text-primary">ğŸš€ Flask + React å…¨æ ˆé¡¹ç›®æ¼”ç¤º</h1>
                    <p class="lead">å®æ—¶APIåŠŸèƒ½æµ‹è¯•</p>
                </div>

                <div class="demo-card">
                    <div class="card">
                        <div class="card-header">
                            <h5>ğŸ“¡ APIçŠ¶æ€</h5>
                        </div>
                        <div class="card-body">
                            <div id="api-status" class="alert alert-info">æ£€æŸ¥ä¸­...</div>
                        </div>
                    </div>
                </div>

                <div class="demo-card">
                    <div class="card">
                        <div class="card-header">
                            <h5>ğŸ‘¥ ç”¨æˆ·ç®¡ç†</h5>
                        </div>
                        <div class="card-body">
                            <button class="btn btn-primary" onclick="getUsers()">ğŸ“‹ è·å–ç”¨æˆ·åˆ—è¡¨</button>
                            <button class="btn btn-success ms-2" onclick="addUser()">â• æ·»åŠ æµ‹è¯•ç”¨æˆ·</button>
                            <button class="btn btn-warning ms-2" onclick="clearUsers()">ğŸ—‘ï¸ æ¸…ç©ºç”¨æˆ·</button>
                            
                            <div id="users-result" class="api-response mt-3" style="display:none;">
                                <h6>å“åº”ç»“æœ:</h6>
                                <pre id="users-data"></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="demo-card">
                    <div class="card">
                        <div class="card-header">
                            <h5>ğŸ”§ é¡¹ç›®ä¿¡æ¯</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>ğŸŒ è®¿é—®åœ°å€:</h6>
                                    <ul>
                                        <li>æœ¬åœ°API: <code>http://localhost:8000/api</code></li>
                                        <li>å¤–ç½‘API: <code>http://13.58.39.217:8000/api</code></li>
                                        <li>GitHubä»“åº“: <a href="https://github.com/Yanyu779/flask-react-fullstack" target="_blank">æŸ¥çœ‹ä»£ç </a></li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h6>âš¡ æŠ€æœ¯æ ˆ:</h6>
                                    <ul>
                                        <li>åç«¯: Flask + SQLAlchemy</li>
                                        <li>å‰ç«¯: React + TypeScript</li>
                                        <li>æ•°æ®åº“: SQLite</li>
                                        <li>UIæ¡†æ¶: Bootstrap</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://127.0.0.1:8000/api';
        
        // æ£€æŸ¥APIçŠ¶æ€
        async function checkAPIStatus() {
            try {
                const response = await fetch(`${API_BASE}/users`);
                if (response.ok) {
                    document.getElementById('api-status').innerHTML = 
                        '<span class="success">âœ… APIæœåŠ¡æ­£å¸¸è¿è¡Œ</span>';
                    document.getElementById('api-status').className = 'alert alert-success';
                } else {
                    throw new Error('APIå“åº”å¼‚å¸¸');
                }
            } catch (error) {
                document.getElementById('api-status').innerHTML = 
                    '<span class="error">âŒ APIæœåŠ¡è¿æ¥å¤±è´¥</span>';
                document.getElementById('api-status').className = 'alert alert-danger';
            }
        }

        // è·å–ç”¨æˆ·åˆ—è¡¨
        async function getUsers() {
            try {
                const response = await fetch(`${API_BASE}/users`);
                const data = await response.json();
                
                document.getElementById('users-result').style.display = 'block';
                document.getElementById('users-data').textContent = JSON.stringify(data, null, 2);
                
                if (data.length === 0) {
                    document.getElementById('users-data').textContent = 'æš‚æ— ç”¨æˆ·æ•°æ® []';
                }
            } catch (error) {
                document.getElementById('users-result').style.display = 'block';
                document.getElementById('users-data').textContent = `é”™è¯¯: ${error.message}`;
            }
        }

        // æ·»åŠ æµ‹è¯•ç”¨æˆ·
        async function addUser() {
            const testUser = {
                name: `æµ‹è¯•ç”¨æˆ·${Date.now()}`,
                email: `test${Date.now()}@example.com`
            };
            
            try {
                const response = await fetch(`${API_BASE}/users`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(testUser)
                });
                
                const data = await response.json();
                document.getElementById('users-result').style.display = 'block';
                document.getElementById('users-data').textContent = 
                    `âœ… ç”¨æˆ·åˆ›å»ºæˆåŠŸ:\n${JSON.stringify(data, null, 2)}`;
            } catch (error) {
                document.getElementById('users-result').style.display = 'block';
                document.getElementById('users-data').textContent = `âŒ åˆ›å»ºå¤±è´¥: ${error.message}`;
            }
        }

        // æ¸…ç©ºç”¨æˆ· (æ¼”ç¤ºç”¨)
        async function clearUsers() {
            try {
                // å…ˆè·å–æ‰€æœ‰ç”¨æˆ·
                const response = await fetch(`${API_BASE}/users`);
                const users = await response.json();
                
                // åˆ é™¤æ‰€æœ‰ç”¨æˆ·
                for (const user of users) {
                    await fetch(`${API_BASE}/users/${user.id}`, {method: 'DELETE'});
                }
                
                document.getElementById('users-result').style.display = 'block';
                document.getElementById('users-data').textContent = `âœ… å·²æ¸…ç©º ${users.length} ä¸ªç”¨æˆ·`;
            } catch (error) {
                document.getElementById('users-result').style.display = 'block';
                document.getElementById('users-data').textContent = `âŒ æ¸…ç©ºå¤±è´¥: ${error.message}`;
            }
        }

        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥APIçŠ¶æ€
        window.onload = checkAPIStatus;
    </script>
</body>
</html>